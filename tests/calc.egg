; A simple group
(datatype G (I) (A) (B))
(function * (G G) G)
(function inv (G) G)
(birewrite (* (* a b) c) (* a (* b c))) ; assoc
(rewrite (* I a) a) ; idl
(rewrite (* a I) a) ; idr
(rewrite (* (inv a) a) I) ; invl
(rewrite (* a (inv a)) I) ; invr

; A is cyclic of period 4
(rewrite (* A (* A (* A A))) I)

(define A2 (* A A))
(define A4 (* A2 A2))
(define A8 (* A4 A4))


(calc ()
    (* A4 A4)
    (* (* A2 A2) (* A2 A2))
    (* A2 (* A2 (* A2 A2)))
)

; Note that (calc ((I G) (b G)) ...) will fail because names must be unused
(calc ((a G) (b G))
    (* (* b (* (inv a) a)) (inv b))
    (* b (inv b))
    (I)
)

