(datatype Math
  (Num rational)
  (Var String)
  (Mul Math Math))

(function hi (Math) (Min rational))
(function lo (Math) (Max rational))

(rule ((= mul (Mul a b)))
      ((= (lo mul) 
          (min (min (* (lo a) (lo b)) (* (lo a) (hi b)))
               (min (* (hi a) (lo b)) (* (hi a) (hi b)))))))

(define x (Var "x"))
(define e (Mul x x))

(assert (= (lo x) -10//1))
(assert (= (hi x)  10//1))

(run 1)

(check (= (lo e) -100//1))

(rule ((= mul (Mul a a)))
      ((= (lo mul) (* (lo a) (lo a)))))

(run 1)
(check (= (lo e) 100//1))
